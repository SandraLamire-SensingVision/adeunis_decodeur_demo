namespace codec {
  /**
   * Decoder class.
   *
   * Main class for decoding purposes.
   * Contains declaration of all required parsers and decode() method (API entry point).
   *
   * See below for explanations on parsers.
   */
  export class Decoder extends CommonDecoder {
    constructor() {
      super();
      this.deviceType = 'modbus';
    }

    /**
     * Get active parsers

     * @param frameCode frame code
     */
    protected override getActiveParsers(frameCode: number): FrameParser[] {
      let activeParsers: FrameParser[] = [];

      // status byte parser
      const statusByteParsers = new ModbusStatusByteParser();

      // Find the specific parser
      let dataParser: FrameParser;

      switch (frameCode) {
        case 0x10:
          dataParser = new Modbus0x10Parser();
          break;
        case 0x20:
          dataParser = new Generic0x20Parser();
          break;
        case 0x2f:
          dataParser = new Generic0x2fParser();
          break;
        case 0x30:
          dataParser = new Generic0x30Parser();
          break;
        case 0x33:
          dataParser = new Generic0x33Parser();
          break;
        case 0x44:
          dataParser = new Modbus0x44Parser(); // decoding int32 values
          break;
        case 0x45:
          dataParser = new Modbus0x45Parser(); // decoding uint16 values
          break;
        case 0x5e:
          dataParser = new Modbus0x5eParser(); // decoding uint16 values
          break;
        case 0x5f:
          dataParser = new Modbus0x5fParser(); // decoding int32 values
          break;
        case 0x60:
          dataParser = new Modbus0x60Parser(); // decoding float(32) values
          break;
        case 0x61:
          dataParser = new Modbus0x61Parser(); // decoding float(32) values
          break;
        case 0x62:
          dataParser = new Modbus0x62Parser(); // decoding uint32 values
          break;
        case 0x63:
          dataParser = new Modbus0x63Parser(); // decoding uint32 values
          break;
        default:
          return activeParsers;
      }

      activeParsers = activeParsers.concat(statusByteParsers);
      activeParsers = activeParsers.concat(dataParser);

      // Return active parser
      return activeParsers;
    }
  }
}
